# Dongle configuration for nice!nano with 128x64 OLED

# Split central (dongle acts as central/receiver)
CONFIG_ZMK_SPLIT=y
CONFIG_ZMK_SPLIT_ROLE_CENTRAL=y
CONFIG_ZMK_SPLIT_BLE_CENTRAL_PERIPHERALS=2

# Display dedicated thread stack size 4x the default (testing stability)
CONFIG_ZMK_DISPLAY_DEDICATED_THREAD_STACK_SIZE=8192

# LVGL memory pool size (default is typically 2048-4096)
CONFIG_LV_Z_MEM_POOL_SIZE=8192

# Increase BLE transmit power for better range/stability
CONFIG_BT_CTLR_TX_PWR_PLUS_8=y

# Display
CONFIG_ZMK_DISPLAY=y
CONFIG_ZMK_SPLIT_BLE_CENTRAL_BATTERY_LEVEL_FETCHING=y

# Mouse/Trackball support - receive input from peripheral
CONFIG_INPUT=y
CONFIG_ZMK_POINTING=y
CONFIG_ZMK_MOUSE=y

# 128x64 OLED specific settings
CONFIG_ZMK_DONGLE_DISPLAY_BONGO_CAT=y
CONFIG_ZMK_DONGLE_DISPLAY_MODIFIERS=y
# CONFIG_ZMK_DONGLE_DISPLAY_LAYER=n  # Re-enabled - room available without dongle battery

# Reduce buffer size for 128x64 OLED stability
CONFIG_LV_Z_VDB_SIZE=64

# Optional: Show dongle battery level (disabled - USB powered)
CONFIG_ZMK_DONGLE_DISPLAY_DONGLE_BATTERY=n

# Optional: Layer name alignment (good for 64px height)
CONFIG_ZMK_DONGLE_DISPLAY_LAYER_TEXT_ALIGN="center"

# Optional: WPM meter
# TODO: figure out why its causing issues when using by app hotkeys
CONFIG_ZMK_DONGLE_DISPLAY_WPM=n

# Display timeout - 5 minutes (300000 milliseconds)
CONFIG_ZMK_IDLE_TIMEOUT=300000

# (중요) Zephyr 4.1 + ZMK_SLEEP=n 상태에서 아래는 경고(=CI 실패) 원인이 될 수 있어 제거
# CONFIG_ZMK_IDLE_SLEEP_TIMEOUT=2147483647

# ===== 진단용: 동글(central)에서만 USB 로그 켜기 =====
CONFIG_ZMK_USB_LOGGING=y
CONFIG_ZMK_LOGGING_MINIMAL=y
CONFIG_ZMK_LOG_LEVEL=4

# ZMK_USB_LOGGING이 내부적으로 선택하는 항목들의 의존성 충족용
CONFIG_LOG=y
CONFIG_CONSOLE=y
CONFIG_SERIAL=y
CONFIG_USB_CDC_ACM=y
